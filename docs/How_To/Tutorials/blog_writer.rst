Create a Blog Writer with Sherpa
================================

In this tutorial we will create a simple blog writer using Sherpa. The
blog writer will be able to read the transcript of a presentation,
create an outline for a blog post, and then write the blog post section
by section using a “Writer” agent that can gather information about the
topic of the section from the web by performing a Google Search and/or
from the transcript itself by performing a Document Search.

Overview
--------

The two main Python files are:

1. ``main.py``: This file instantiates
and configures a Sherpa agent with access to various “actions” (wrappers
for “tools”) such as Google search (with citation validation) and
document search (for retrieving relevant context from the transcript).
The agent takes statements that comprise “evidence” for claims to be
made in the blog post and extends and expands them into paragraphs.
These pieces of “evidence” are part of the blog outline generated by the
second component.

2. ``ouliner.py``: This file houses the Outliner
component which performs the following:

* Preprocessing (chunking) the document. This is necessary due to GPT-3.5’s
  context window limit of 4096 tokens.

* Analyzing the transcript. This consists of two steps: First, a short list of
  “key insights” is extracted from each chunk. In the next step, these lists are
  concatenated together and a blog post “blueprint” (analogous to an “essay
  outline”) is synthesized from the list of all key insights. This blueprint can
  be thought of as a tree with three levels of depth:

  1. Thesis Statement: A single statement that forms the core message of the
  blog post (essentially a topic and a claim made about the topic).

  2. Supporting Arguments: A list of statements
  that support the Thesis Statement at a high level.

  3. Evidence: Lists of
  statements that provide factual evidence for the Supporting Argument
  under which they appear. The blueprint is output as a JSON string.

How to Install
--------------

Step 1. Install Python 3.9 using your preferred installation method.

Step 2. Create a folder for storing the blog writer code and
input/output files:

.. code:: bash

   cd <your development directory>
   mkdir sherpa_blog_writer
   cd sherpa_blog_writer

Step 3. You may wish to create a virtual environment to isolate the
Python libraries used for this tutorial from your other Python code.
This step is optional but highly recommended. An example of this (using
``venv``) would be:

.. code:: bash

   python -m venv bwvenv
   source bwvenv/bin/activate

Step 4. Install the Sherpa library using ``pip``.

.. code:: bash

   pip install sherpa_ai

Step 5. Download all files from
(https://github.com/Aggregate-Intellect/sherpa/tree/main/demo/blog_writer)
into this directory.

Step 6. Install additional requiremetns with
``pip``.

.. code:: bash

   pip install -r requirements.txt

Step 7. Rename the file ``.env.sample`` to ``.env``. Then open it in
your favourite text editor and add your OpenAI and Serper API keys.

Step 8. Source the environment variables from the ``.env`` file with
``direnv`` if you use it, or alternatively using:

.. code:: bash

   export $(grep -v '^#' .env | xargs)

How to Use
----------

Step 1. Currently the blog writer needs the transcript in both ``.txt``
*and* in ``.pdf`` formats. So the first step is to ensure you have both
files and copy them into the current (blog writer) directory. Most text
editors will have an “Export to PDF” feature. Alternatively, you can
“print” the file as a PDF. Name the files ``transcript.txt`` and
``transcript.pdf``.

Step 2. Run:

.. code:: bash

   python main.py --config agent_config.yml --transcript transcript.txt

The blog writer will output verbose feedback to the console as it works
through the files. The blueprint will be saved as ``blueprint.json`` and
the final output (blog post) as ``blog.md``.
